{
  "version": 3,
  "sources": ["../src/server.js"],
  "sourcesContent": ["import crypto from 'crypto';\r\nimport express from 'express';\r\nimport compression from 'compression';\r\nimport helmet from 'helmet';\r\nimport context from 'express-http-context';\r\nimport clusterize from '@sliit-foss/clusterizer';\r\nimport { correlationId } from \"./utils\";\r\nimport { moduleLogger } from '@sliit-foss/module-logger';\r\nimport { errorHandler, responseInterceptor } from './middleware';\r\nimport config from './config';\r\nimport routes from './routes';\r\n\r\nconst logger = moduleLogger('Server');\r\n\r\nclusterize(\r\n  () => {\r\n    const app = express();\r\n\r\n    app.use(helmet());\r\n    app.use(compression());\r\n\r\n    app.use(express.json({ limit: '1mb' }));\r\n    app.use(express.urlencoded({ extended: true }));\r\n\r\n    app.use(context.middleware);\r\n\r\n    app.use((req, _res, next) => {\r\n      context.set('correlationId', req.headers[correlationId] ?? crypto.randomBytes(16).toString(\"hex\"));\r\n      next();\r\n    });\r\n\r\n    app.use(`/api`, routes);\r\n\r\n    app.use(responseInterceptor);\r\n\r\n    app.use(errorHandler)\r\n\r\n    app.listen(config.PORT, config.HOST, () => {\r\n      logger.info(`User service listening on ${config.HOST}:${config.PORT}`);\r\n    });\r\n  },\r\n  { logger },\r\n);"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;AAAA,oBAAmB;AACnB,qBAAoB;AACpB,yBAAwB;AACxB,oBAAmB;AACnB,kCAAoB;AACpB,yBAAuB;AACvB,mBAA8B;AAC9B,2BAA6B;AAC7B,wBAAkD;AAClD,oBAAmB;AACnB,oBAAmB;AAEnB,MAAM,aAAS,mCAAa,QAAQ;AAAA,IAEpC,mBAAAA;AAAA,EACE,MAAM;AACJ,UAAM,UAAM,eAAAC,SAAQ;AAEpB,QAAI,QAAI,cAAAC,SAAO,CAAC;AAChB,QAAI,QAAI,mBAAAC,SAAY,CAAC;AAErB,QAAI,IAAI,eAAAF,QAAQ,KAAK,EAAE,OAAO,MAAM,CAAC,CAAC;AACtC,QAAI,IAAI,eAAAA,QAAQ,WAAW,EAAE,UAAU,KAAK,CAAC,CAAC;AAE9C,QAAI,IAAI,4BAAAG,QAAQ,UAAU;AAE1B,QAAI,IAAI,CAAC,KAAK,MAAM,SAAS;AAC3B,kCAAAA,QAAQ,IAAI,iBAAiB,IAAI,QAAQ,0BAAa,KAAK,cAAAC,QAAO,YAAY,EAAE,EAAE,SAAS,KAAK,CAAC;AACjG,WAAK;AAAA,IACP,CAAC;AAED,QAAI,IAAI,QAAQ,cAAAC,OAAM;AAEtB,QAAI,IAAI,qCAAmB;AAE3B,QAAI,IAAI,8BAAY;AAEpB,QAAI,OAAO,cAAAC,QAAO,MAAM,cAAAA,QAAO,MAAM,MAAM;AACzC,aAAO,KAAK,6BAA6B,cAAAA,QAAO,QAAQ,cAAAA,QAAO,MAAM;AAAA,IACvE,CAAC;AAAA,EACH;AAAA,EACA,EAAE,OAAO;AACX;",
  "names": ["clusterize", "express", "helmet", "compression", "context", "crypto", "routes", "config"]
}
